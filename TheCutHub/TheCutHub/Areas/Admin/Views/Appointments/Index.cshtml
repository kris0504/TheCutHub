@using X.PagedList
@using X.PagedList.Mvc.Core
@using X.PagedList.Mvc.Core.Common
@using X.PagedList.Web.Common
@model IPagedList<TheCutHub.Models.Appointment>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "All Appointments";
}

<div class="container mt-5">
    <h2 class="section-title text-center mb-4">
        <i class="bi bi-calendar-check-fill me-2 text-gold"></i> @ViewData["Title"]
    </h2>

   
    <form method="get" class="row gx-2 gy-2 mb-3">
        <div class="col-md-3">
            <input name="client" value="@ViewBag.Client"
                   class="form-control" placeholder="Client email" />
        </div>
        <div class="col-md-2">
            <input type="date" name="date" value="@ViewBag.Date"
                   class="form-control" />
        </div>
        <div class="col-md-2">
            <select name="sort" class="form-select">
                <option value="date_desc" selected="@((string)ViewBag.Sort=="date_desc")">Date ⬇</option>
                <option value="date" selected="@((string)ViewBag.Sort=="date")">Date ⬆</option>
                <option value="client" selected="@((string)ViewBag.Sort=="client")">Client ⬆</option>
                <option value="client_desc" selected="@((string)ViewBag.Sort=="client_desc")">Client ⬇</option>
            </select>
        </div>
        <div class="col-md-2">
            <button class="btn btn-outline-gold w-100">
                <i class="bi bi-filter me-1"></i> Apply
            </button>
        </div>
    </form>

    <div class="table-responsive">
        <table class="table table-dark table-bordered align-middle">
            <thead>
                <tr class="text-gold text-uppercase">
                    <th>Client</th>
                    <th>Barber</th>
                    <th>Service</th>
                    <th>Date&nbsp;&amp;&nbsp;Time</th>
                    <th style="width:25%">Notes</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var a in Model)
                {
                    <tr>
                        <td>@a.User.Email</td>
                        <td>@a.Barber.FullName</td>
                        <td>@a.Service.Name</td>
                        <td>@a.AppointmentDateTime.ToString("dd.MM.yyyy HH:mm")</td>
                        <td><div style="max-height:4.5rem;overflow:auto;">@a.Notes</div></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="d-flex justify-content-center mt-4">
        @Html.PagedListPager(
                 Model,
                 page => Url.Action("Index",
                 new
                 {
                     page,
                     client = ViewBag.Client,
                     date = ViewBag.Date,
                     sort = ViewBag.Sort
                 }),
                 new PagedListRenderOptions
        {
            UlElementClasses = new[] { "pagination" },
            LiElementClasses = new[] { "page-item" },
            PageClasses = new[] { "page-link" },
            Display = PagedListDisplayMode.IfNeeded
        })
    </div>
</div>
