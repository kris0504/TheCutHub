@model TheCutHub.Models.Appointment

@{
    ViewData["Title"] = "Create";
    var selectedDate = ViewBag.SelectedDate as DateTime?;
    var availableSlots = ViewBag.Slots as List<TimeSpan>;

}
<h2>Create Appointment</h2>

<form asp-action="Create" method="post">
    <div class="form-group">
        <label>Date</label>
        <input type="date" name="date" class="form-control"
               value="@selectedDate?.ToString("yyyy-MM-dd")"
               onchange="this.form.submit()" />

    </div>

    <div class="form-group">
        <label>Service</label>
        <select name="serviceId" class="form-control" asp-items="ViewBag.ServiceId" required></select>
    </div>

    <div class="form-group">
        <label>Barber</label>
        <select name="barberId" class="form-control" asp-items="ViewBag.BarberId" required></select>
    </div>

    @if (availableSlots != null)
    {
        <h4>Available Time Slots:</h4>
        <div class="row">
            @foreach (var slot in availableSlots)
            {
                <div class="col-md-2 mb-2">
                    <button name="timeSlot" value="@slot" class="btn btn-primary w-100">
                        @slot.ToString(@"hh\:mm")
                    </button>
                </div>
            }
        </div>

        @if (!availableSlots.Any())
        {
            <p class="text-danger">No available slots for this date.</p>
        }
    }
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
